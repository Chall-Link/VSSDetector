=================================================

# Chall-Link「VSSDetector」 - VSS スナップショット 汎用パス取得ツール  
## 日本語版 Ver.1.0.0  
## Windowsの隠れた機能を誰でも使えるように機能解放  
## 先進的 VSS活用ユーティリティ  

**【著作権者】** Chall-Link（シャルリンク）  
**【開発地】** Developed in Japan  
**【ライセンス】** MIT License  
**【種別】** フリーソフトウェア（オープンソース）  

=================================================
> 💡 本ドキュメントでは「アーカイブ」「バックアップ」「圧縮」をほぼ同じ意味として混在使用しています  
> 💡 「スナップショット」は「シャドーコピー」とも呼ばれます
> 

&emsp; 

## ファイル構成
VSSDetector/
├── ChaL-VSSDetector.bat          # メインスクリプト
├── README.md                     # 説明書（本ファイル）
└── docs/
    └── advanced-backup-guide.md  # 活用ガイド

&nbsp;

## ■概要：画期的なブレークスルー：あなたのWindowsに眠る秘密の場所

Chall-Link「VSSDetector」を使えば、Windowsのスナップショット＝「過去の任意の時点での静的な（変化しない）ドライブ／フォルダ／ファイル」に7-zipなどのソフトウェアから誰でも簡単に直接アクセスできるようになります。
従来、この機能は主にWindowsおよび市販ソフト経由などでしか使えませんでした。  

&nbsp;

## ■ 動作環境
- **ダウンロードリンク**:  [VSSDetector-GitHub Release](https://github.com/Chall-Link/VSSDetector/releases)掲載の「Source code (zip)」をダウンロードしてください。GitHubの Rawダウンロード でダウンロードすると改行コードがLFになり動作しませんのでご注意ください。 
- **文字コード・改行コード**: 本スクリプトは日本語対応のWindowsスクリプトで、Shift-JISエンコーディングとCRLF改行コードでなければ正常に動作しません。
- Windows10 Pro 64bit（動作確認済み）、理論上はWindows7 SP1以上で動作可能（未確認のため自己責任でテスト推奨）
- **必要条件**: PowerShell 2.0以上（Windows標準搭載）、管理者権限、VSSサービスが有効
- **併用推奨ソフト**: Chall-Link「PreFAS Backup」（[PreFAS Backup-GitHub Release](https://github.com/Chall-Link/PreFAS-Backup/releases) 掲載の「Source code (zip)」から入手 
）、7-Zip（LGPLライセンス）（ https://www.7-zip.org/  から入手）

&nbsp;

## ■スクリプト利用時に「WindowsによってPCが保護されました」が出た場合
初回利用時にWindows Defender SmartScreenが警告を表示する場合があります。これは署名されていない新しいソフトウェアに対する標準的な警告です。

**安全性について：**
- ESETウイルススキャン（ローカル確認済み）
- 完全オープンソース（内容確認可能）

**実行方法：** 警告画面で「詳細情報」→「実行」をクリック

&nbsp;

**👉 `＊＊このスクリプトはVSS機能を誰でも使えるように解放することを可能にします！＊＊`**

&nbsp;

## ■体験：基本的な使い方　～まずは体験してみよう。驚きの瞬間！～ 

### ■ 3分でできる感動体験 
> ⚠️ ここではVSSDetectorの使い方のみを説明します。前提条件として事前に復元ポイントが作成されている必要がありますが、このスクリプトは情報取得機能のみで復元ポイントが無い状態で実行しても「復元ポイントが作成されていない可能性があります」というメッセージが出るだけでシステムに影響を及ぼす事はありません。  
> わからない場合、とりあえず実行してみていただいても問題ございません。復元ポイント作成など詳しい手順は別の活用ガイド( [advanced-backup-guide.md](https://github.com/Chall-Link/VSSDetector/blob/main/docs/advanced-backup-guide.md) )を参照ください。  
> なお、新たに復元ポイントを作成して良いかなどは、PCの管理者と相談し許可を得てください。

1. ChaL-VSSDetector.batを右クリックして管理者権限で実行

2. システム内のスナップショット情報が自動解析され、以下の形式で表示：
```
   ────────────────────────────
   [1] HarddiskVolumeShadowCopy3 (ドライブ D:)
       作成日時: 2024/06/06 14:30:25
       種類: システム復元ポイント
       ドライブ全体指定時パス表記: \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy3\*
       フォルダ指定時パス表記: \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy3\(フォルダ名)
   ────────────────────────────
```
> 結果はChaL-RESULT-VSSDetector.txtファイルにも保存されています  
> 「種類: システム復元ポイント」以外の物は各種ソフトが作成した物なので利用しないで下さい

&nbsp; 

**👉 `これで、VSSDetector VSSパス を取得する事ができました！ `**

&nbsp;

> ⚠️ ここから先の体験は、別途 7-Zip（ https://www.7-zip.org/ ) が必要となります。  
> 必要に応じてインストールして下さい。

&nbsp;

3. 必要な VSSDetector VSSパスをコピーして、他のツールで使用

&emsp; &emsp; 👉 **`ここでは、7-Zip File Manager を使って VSSのスナップショットの中を覗いてみましょう！`**

4. 2\. のドライブ全体指定時パス表記 から、**最後の*を除外した**部分をコピーします。  

5. 7-Zip File Managerを起動
6. アドレスバーにVSSパスを貼り付けてEnter

&nbsp;

**👉 `過去のある時点の状態のファイル・フォルダのスナップショットが出現しました！`**

&nbsp;

> ⚠️ ここではトラブルを避けるために閲覧以外の操作は行わないでください。

&nbsp;

## ■特徴： VSSDetectorの優れた特徴  
### ● 隠れたスナップショットの完全可視化
- システムに保存されているすべてのスナップショットを自動検出
- 作成日時、対象ドライブ、作成元を適切に自動識別

### ● 実用的なVSSパスの自動生成
- 7-zipで直接使用可能なVSSパス形式を自動提供
- ドライブ全体用とフォルダ指定用の両パターンを完全サポート
- コピー&ペーストでその場で他のツールで利用可能

### ● いつでも参照可能な結果ファイル出力
- 画面表示と同時にテキストファイル（ChaL-RESULT-VSSDetector.txt）に保存
- 重要事項も併せて提示
- エラーハンドリングも充実

&nbsp;

## ■バックアップ：バックアップ処理へ適用
### バックアップでVSSを使うメリット

VSS をバックアップのソースとして使うと言う事は、変化しない静的なドライブ／フォルダのイメージをソースとして使う事ができると言う事です。  
例えば、実際のフォルダをソースとした場合、バックアップ処理中は元フォルダでファイルで作業するはできず、処理が終わるまで待っていなければなりませんでした。同時に作業をするとバックアップが失敗する可能性があったからです。
VSSDetectorはVSSの機能を解放し、この課題を解決します。

ドライブ丸ごと7-Zipでバックアップするような大規模処理の場合、バックアップと編集作業の継続を両立することは不可能です。  
また7-Zipで数日間もの長時間処理を連続動作させるには、数分で処理する場合と異なる操作快適性の違いが発生します。  

そこで開発されたのが、別スクリプトの Chall-Link「PreFAS Backup」です。
VSSDetectorと、PreFAS Backupを使えば、VSS を使って数日かかるバックアップ処理もバックアップしながら編集作業を続けらるようにスクリプトが最適化されています。

また、PreFAS Backupは貴重なファイルを長期的に安全保存する事をコンセプトにしており、作成した、暗号化バックアップファイルをクラウドや M-Disc（100年耐久光ディスク）に保存することで、災害などから貴重なファイルを守る事を目標にしています。

&nbsp;

## ■用途：PreFAS Backup の活躍シーン
- **写真・動画管理**／貴重な記録写真、プライベートの大切な想い出の完全保護
- **クリエイター・デザイナー**／完成作品の確実な長期保存
- **ソフトウェア開発者**／安定版プログラムの戦略的バックアップ
- **文書作成・事務作業**／重要文書、文芸作品の確実な保護
- **システム管理・IT担当者**／VSSについての深い理解とシステムメンテナンスへの応用

&nbsp;

## ■注意事項

### ■ 重要な注意事項
- VSSパス使用中のディスククリーンアップでの「システムの復元とシャドウコピー」の削除  
- ドライブ全体指定時は末尾に「\*」必須、フォルダ指定時は(フォルダ名)を実際の名前に置換
- 7-Zip File Manager使用の場合は、ドライブ全体指定時パスの末尾の*を削除してパス欄に入力 

### ■ トラブルシューティング
- 「復元ポイントが作成されていない可能性があります」→ 復元ポイントが未作成、またはVSSサービスが止っている可能性
- 「管理者権限が必要」→ 右クリックから「管理者として実行」で起動

**👉 `Chall-Link「VSSDetector」で、従来は高額な市販バックアップソフトでしか得られなかった成果を、フリーウェアで享受することが可能となります`**

&emsp; 

##  ■広がる適用可能性

Chall-Link「VSSDetector」は、様々な分野に応用可能です
- **セキュリティ・監査**　（ファイル・バックアップ）  
- **システム管理・運用**　（システム障害時の原因調査）  
- **ディスク解析・最適化ツール**　（フォルダの新旧状態比較）  

### ● バックアップでの活用
- スナップショットをバックアップソースにし、アーカイブ処理中でも実ファイルで作業継続可能
    - Chall-Link「PreFAS」（大規模）、7-Zip（小規模）、robocopy、xcopy等での今までできなかった VSSコピーを実現

### ● ファイル比較・復旧
- 過去（スナップショット）と現在（実ファイル）の内容の比較
- 過去（スナップショット）と現在（実フォルダ）の内容の比較

### ● 過去のファイルの抽出
- スナップショットからの紛失ファイルの復元
- スナップショットからの過去のバージョンのファイルを抽出

### ● 他のツールでの応用
- バッチファイルでの自動化処理への組み込み
- PowerShellスクリプトとの連携

### ● 企業・プロフェッショナル用途
- 定期的なバックアップ処理の自動化
- システム管理業務での活用
- データ復旧作業での強力なツールとして

&emsp; 

##  ■ライセンス・免責事項
本ソフトウェアはフリーソフトウェア（MITライセンス）です。著作権はChall-Linkに帰属します。
本ソフトウェアの使用による損害や障害について、著作者は一切の責任を負いません。  
転載・配布は自由ですが、出典として『Chall-Link「VSSDetector」』を明記してください。

ご意見・ご感想はGitHubリポジトリの [Issues](https://github.com/Chall-Link/VSSDetector/issues) にてお願いします。  
ただし個別サポートや返信は行っておりません。

&nbsp;

## タグ
VSS, スナップショット, 復元ポイント, 7zip, PowerShell, vssadmin, システム管理, windows-tools, 大容量, バックアップ  

[Tags: VSS, snapshot, restore-point, 7zip, PowerShell, vssadmin, system-administration, windows-tools, large-data, backup]

&nbsp;

以上
