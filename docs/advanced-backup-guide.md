=================================================  
  
# Chall-Link「VSSDetector」 活用ガイド  
## 復元ポイント VSS スナップショットを使った7-Zip暗号化アーカイブ  
## ドライブ丸ごとバックアップも可能！

## Windowsの隠れた機能を誰でも使えるように機能解放！
## 市販ソフトレベルのバックアップをフリーウェアで

## 【著作権者】	Chall-Link（シャルリンク）  
  
=================================================  

&nbsp;

## ■この活用ガイドで使用するソフト

&emsp;**1. 7-Zip機能拡張版スクリプト Chall-Link「PreFAS Backup」※（GitHubから入手）**  
&emsp;**2. 7-Zip（LGPLライセンス）（https://www.7-Zip.org/ から入手）**  

> ※ VSSDetector公開後、同時期に公開予定  

&nbsp;

## ■概要：このガイドについて
Chall-Link「VSSDetector」は、Windowsの隠れた機能 **VSS スナップショット**＝ある時点で変更されない形で保存されているドライブの状態を一般ユーザーが自由に再利用できるよう機能解放します

活用ガイドでは、VSSDetectorとChall-Link「PreFAS Backup」または7-Zipの組合わせを例に、Windows復元ポイントをアーカイブ元として、バックアップソフトやバックアッププログラムを実行する具体的手順を紹介します  

&nbsp;

## ■手順：具体的な使用例

### １．目標：VSSスナップショット内のフォルダをアーカイブソースとして 7-Zipアーカイブを作成  
> 従来のソースのパス指定例： D:\  ※ 処理中は D:での作業を中断する必要があった  
>　　　　　　　　　　　↓  
> VSSDetector「VSSパス」指定例： \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\*  ※処理中でも作業継続可能

**VSSDetectorで、大容量フォルダ（ドライブ）でPC作業を継続しながら、同時に大容量フォルダ（ドライブ）の7-Zip バックアップ処理が可能になります！**

&nbsp;

### ２．事前準備：復元ポイントの作成
> 復元ポイントの新規作成は、管理者・共同責任者の同意の上実施して下さい
> 復元ポイント作成時に目安として対象ドライブに20%以上の空き容量が必要です。空き容量が不足していると正常処理ができない場合がありますのでご注意下さい

#### ２．１．ステップ1：システムの復元機能の有効化  
&emsp;**2.1.1 システムの復元設定画面へのアクセス**  
&emsp;&emsp;Windowsの検索窓で「復元ポイントの作成」を検索し開きます  
&emsp;&emsp;システムのプロパティウィンドウ／システムの保護タブが開きます  

&emsp;**2.1.2 【必須設定】システムドライブ（通常 C:）の保護設定**  
&emsp;&emsp;システムの復元機能はシステムドライブ（C:）を有効にしないと他のドライブは有効にできません
&emsp;&emsp;「Windows(C:)（システム）」の保護が無効の場合は、システムドライブ（C:）を選択し  
&emsp;&emsp;「構成」→「システムの保護を有効にする」を選択して システムドライブ（C:）の保護を有効にします  
&emsp;&emsp;**ディスク領域の使用量：ディスクサイズの5-10%を推奨設定**  

&emsp;**2.1.3 【重要設定】データドライブ（例 D:など）の保護設定**  
&emsp;&emsp;バックアップ対象のデータドライブを選択し「構成」をクリック  
&emsp;&emsp;「システムの保護を有効にする」を選択  
&emsp;&emsp;**ディスク領域の使用量：1-3%を推奨設定**（小容量ドライブでは1-2%）  

  > 有効にしただけではまだ復元ポイントは作成されません  

&nbsp;

#### ２．２．ステップ2：復元ポイントの作成  

&emsp; **2.2.1 復元ポイント作成プロセスの開始**  
&emsp; &emsp;「システムのプロパティ」ウィンドウの「システムの保護」タブの「作成」ボタンをクリック  

&emsp; **2.2.2 識別用説明の入力**  
&emsp; &emsp;復元ポイントの説明欄に識別しやすい名称を入力  
&emsp; &emsp;例：「PreFAS-25-06-06-1200」  

&emsp; **2.2.3 復元ポイント作成処理の実行**  
&emsp; &emsp;「システムの保護」ウィンドウの「作成」ボタンをクリック → その時点で有効になっている全ドライブのスナップショットの作成が開始  

&emsp; **2.2.4 作成成功の確認**  
「復元ポイントは正常に作成されました」の表示を確認  

&nbsp;

**ドライブの静的な状態保存＝Windows VSS スナップショットの作成が完了しました！**  

&nbsp;

### ３．VSSDetectorによる VSSパス取得  

**VSSDetectorで、復元ポイントのVSSスナップショットのVSSパスを取得します**  

#### ３．１．ステップ1：VSSDetectorの実行  

&emsp;**3.1.1 管理者権限での実行**  
&emsp;&emsp;ChaL-VSSDetector.batを右クリックし、「管理者として実行」  

&emsp;**3.1.2 VSSスナップショットの解析処理が実行されます**  

&emsp;**3.1.3 実行完了**  
&emsp;&emsp;「スクリプトの実行が完了しました」のメッセージを確認したら、
&emsp;&emsp;**画面表示と同一の詳細結果が外部ファイルとして出力されています**ので画面を閉じても結構です  

&emsp; 

#### ３．２．ステップ2：VSSDetector「VSSパス」情報の確認と活用  

&emsp;**3.2.1 詳細結果ファイルのアクセス**  
&emsp;&emsp;実行フォルダに作成された「ChaL-RESULT-VSSDetector.txt」を開きます

&emsp;**3.2.2 VSSDetector「VSSパス」情報の表示例**：

```
   ────────────────────────────
   [1] HarddiskVolumeShadowCopy1 (ドライブ D:)
       作成日時: 2024/06/06 14:30:25
       種類: システム復元ポイント
       ドライブ全体指定時パス表記: \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\*
       フォルダ指定時パス表記: \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\(フォルダ名)
   ────────────────────────────
```

&emsp; 

&emsp;**3.2.3 VSSDetector「VSSパス」の選択とコピー**  
&emsp;&emsp;バックアップ対象ドライブ／フォルダに対応する最適なVSSパスをコピー

> ⚠️ VSSDetector「VSSパス」ドライブ全体指定と、フォルダ指定の違い
> **ドライブ全体指定**：末尾に「\*」が必要（例：〜Copy1\*）  
> **特定フォルダ指定**：(フォルダ名)を実際の正確なフォルダ名に置換

&emsp; 

**🚀 VSSスナップショットへ直接アクセスするためのVSSパスの抽出が完了しました！**
**次に、7-Zip機能拡張版スクリプト Chall-Link「PreFAS Backup」または7-Zip File ManagerによるVSSスナップショットを元にした7-Zipアーカイブの作成方法を説明します**

&emsp; 

### ４．アーカイブ・バックアップの実行

#### ４．１． 設定条件、注意事項

- **設定例：**  
**【Case1】短時間で処理が終わる、小規模フォルダをアーカイブソースとする場合**  
ソースフォルダ： d:\folder1\sub-folder2\  
出力先： e:\7-Zip-output\

&emsp; 

**【Case2】長時間にわたる、ドライブ全体など大規模ソースをアーカイブソースとする場合**  
※ドライブ全体を実行する場合は12時間以上かかることがありますのでご注意下さい

- **重要な確認事項：**
本番ではバックアップ作成後に7-Zip File Managerでファイルを開きファイルツリーを正しく閲覧できるかなど必ず確認してください

- **免責事項：**
バックアップ後にソースを削除し、パスワードが一致しない、バックアップも破損していた場合など、データ損失について、Chall-Linkは一切の責任を負いません

#### ４．２．方法1：7-Zip GUIでの手動実行（小規模アーカイブ向けにおすすめ）

**【Case1】短時間で処理が終わる、小規模フォルダをアーカイブソースとする場合**  

&emsp; 

&emsp;**4.2.1 「7-Zip File Manager」を管理者権限で起動**

&emsp;**4.2.2 VSSDetector「VSSパス」での直接アクセス**  
&emsp;&emsp;7-Zip File Managerの場合は、ドライブ全体指定時パス表記の末尾の*を削除して利用して下さい**  
&emsp;&emsp;アドレスバーに VSSDetector「VSSパス」を入力 **（末尾の\*は除く）**  
&emsp;&emsp;例：\\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\

&emsp;**4.2.3 アーカイブターゲットの選択**  
&emsp;&emsp;対象フォルダ（例：folder1\sub-folder2\）を選択 → 「追加」を選択で圧縮ウィンドウが開く

&emsp;**4.2.4 【重要】出力先の変更**  
&emsp;&emsp;このままでは圧縮ファイルの出力先が、スナップショットの内部  
&emsp;&emsp;\\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\  
&emsp;&emsp;に設定されています。ここはスナップショットの内部で書き込みできません。  
&emsp;&emsp;圧縮先を出力可能な実際の出力フォルダ（ e:\7-Zip-output\ ）に変更します。  
&emsp;&emsp;出力ファイル名を file-1.7z にした場合、このようになります
&emsp;&emsp;e:\7-Zip-output\file-1.7z

&emsp; 

**【Case2】長時間にわたる、ドライブ全体など大規模ソースをアーカイブソースとする場合**  

> **～～～ 省略 ～～～**　　  
> **👉 ドライブ全体などの大規模長時間処理にはGUI方式よりも 7-Zip機能拡張版スクリプト Chall-Link「PreFAS Backup」の利用をお奨めします**　　

&emsp; 

#### ４．３．方法2：PreFAS Backupでの拡張7-Zip処理の実行（大容量バックアップ向け）

&emsp; 

---
 **■ Chall-Link「PreFAS Backup」とは…**

Chall-Link「PreFAS Backup」は、災害から貴重なファイルを守るため、大規模ドライブやフォルダを7-ZipのAES-256暗号化で可搬性のあるアーカイブに変換し、クラウドやM-Disc（100年耐久光ディスク）に保存することをコンセプトに開発されたツールです。

**【 PreFAS Backupの特徴 】**
- セキュアなアーカイブ：AES-256暗号化でデータを強力に保護
- 負荷低減と作業継続：7-ZipのCPU負荷を制御し、高負荷継続の抑制とソースフォルダでの編集作業を快適に  
- 大規模対応：テラバイト級のフォルダ/ドライブを全自動でバックアップ  
- 光ディスク最適化：25GB、50GB、100GBの光ディスクに効率的な分割サイズ設定  
- プロ品質の信頼性：市販ソフト並みのエラーハンドリングシステム  
---

&emsp; 

&emsp;**4.3.1 PreFAS-Sub.batの設定**  
&emsp;&emsp;テキストエディタでChaL-PreFAS-Backup-SUB.batを開き、変数値を編集します：

**【Case1】短時間で処理が終わる、小規模フォルダをアーカイブソースとする場合**  

```
set SOURCE_FOLDER="\\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\folder1\sub-folder2\"
```

**【Case2】長時間にわたる、ドライブ全体など大規模ソースをアーカイブソースとする場合**  

```
set SOURCE_FOLDER="\\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\*"
```
> この場合は、末尾に*が必要です

&emsp;**4.3.2 その他の必須／重要変数の設定**  
&emsp;&emsp;テキストエディタでChaL-PreFAS-Backup-SUB.batを開き、変数値を編集します：

&emsp;&emsp;**出力アーカイブファイル名の設定**  
&emsp;&emsp;&emsp;`file-1` （拡張子不要）

&emsp;&emsp;**アーカイブファイル出力フォルダの設定**  
&emsp;&emsp;&emsp;`e:\7-Zip-output\`

&emsp;&emsp;**除外ファイル、除外フォルダの指定**  
&emsp;&emsp;&emsp;`set EXCLUDE=-xr!"*.tmp" -xr!"*.temp"`

&emsp;**4.3.3 PreFAS-Main.batの確実な実行**  
&emsp;&emsp;右クリック → 「管理者として実行」

&emsp;**4.3.4 パスワード設定**  
&emsp;&emsp;AES-256暗号化用の強力なパスワードを2回入力（英数字や記号を含む20〜30桁を推奨）

&emsp;**4.3.5 自動処理の開始**  
&emsp;&emsp;- 背景色が水色で表示され、高度な自動処理が開始  
&emsp;&emsp;- Chall-Link「PreFAS Backup」によりCPU負荷が制御され、アーカイブ処理中に通常通りのファイル編集が可能  
&emsp;&emsp;- 完了時に「Everything is Ok」が表示され処理が成功


## ■PreFAS Backup利用上の重要事項   

### １．必須事項
&emsp;アーカイブが完成したら7-Zip File Managerで開き、パスワードが有効か？ファイル一覧を閲覧できるかを確認
&emsp;本ソフトウェアの使用による損害や障害について、著作者は一切の責任を負いません

### ２．禁止事項
&emsp;処理中にディスククリーンアップで「システムの復元とシャドウコピー」をクリーンアップする事

### ２．注意事項
&emsp;長時間処理を実行する場合はPCファンがいつもより高速回転するなど異常を感じた場合、PreFAS Backupの使用を中止

### ３．推奨事項
&emsp;3.1 最新状態のバックアップを作成するために PreFAS Backup実行直前に復元ポイントを作成
&emsp;3.2 パスワードは大切に保存（紛失した場合、復元手段は存在しません）

&emsp; 

## ■トラブルシューティング・FAQ

### １．PreFASでVSSDetector「VSSパス」が認識されない
&emsp;**1.1 確認項目**  
&emsp;&emsp;以下の項目を確認してください  
&emsp;&emsp;- ドライブ全体指定：末尾に「\*」が必須  
&emsp;&emsp;- フォルダ指定：実際の正確なフォルダ名に置換されているか  
&emsp;&emsp;- 対象復元ポイントが確実に存在しているか

### ２．バックアップ処理中にエラーが発生した
&emsp;**2.1 段階的確認**  
&emsp;&emsp;以下を段階的に確認してください  
&emsp;&emsp;- 最新の復元ポイント情報を使用できているか？VSSDetectorで情報を再取得して確認  
&emsp;&emsp;- Results_PreFAS_ERROR_*.logファイルの詳細内容を精査

### ３．復元ポイントが作成されない
&emsp;**3.1 基本要件確認**  
&emsp;&emsp;以下の基本要件を確認してください  
&emsp;&emsp;- ディスク容量不足の有無  
&emsp;&emsp;- システムの復元設定  
&emsp;&emsp;- VSSサービスの動作状況

### ４．処理後の復元ポイントを削除すべきか？
&emsp;**4.1 判断基準**  
&emsp;&emsp;以下の判断基準に従ってください  
&emsp;&emsp;- ディスク容量に余裕がある場合：そのまま温存して将来的な活用に備える  
&emsp;&emsp;- 容量が制限される場合：設定した容量制限を超えると古いものから自動削除される仕組みを活用

## ■復元ポイントの管理・削除

### １．復元ポイントの安全な削除方法（※共同利用環境では必ず管理者・責任者と事前相談してから実施）

&emsp;**1.1 アクセス手順**  
&emsp;&emsp;Windowsの検索窓で「復元ポイントの作成」を検索しアクセス

&emsp;**1.2 削除実行**  
&emsp;&emsp;削除対象ドライブを慎重に選択し「構成」をクリック

&emsp;**1.3 削除オプション選択**  
&emsp;&emsp;以下のいずれかを選択：  
&emsp;&emsp;- **「削除」**：該当ドライブの復元ポイントをすべて完全削除  
&emsp;&emsp;- **「システムの保護を無効にする」**：削除と共に今後の復元ポイント作成機能も完全停止

## ■この革命的手法の本質的価値と歴史的意義

### １．従来の根本的制約からの完全解放
このスクリプトは単なる技術的手法を越えて、**現代のバックアップ・プロセスに一石を投じる革新的なアプローチ**です。これまで相反関係にあった「確実なバックアップ実行」と「継続的な作業」を、フリーウェアレベルで両立させることに成功しました。

### ２．生産性革命の実現
従来は避けられなかった数時間〜1日の作業停止時間を完全にゼロ化し、創造的活動の中断を根本的に排除します。

### ３．技術的ブレークスルーの歴史的意義
Chall-Link「VSSDetector」による技術的発見は、個人レベルでの「攻撃的創造」と「堅実な保護」の同時実現を可能にした、デジタル時代における歴史的な技術革新です。

### ４．対象分野
特に大容量データを日常的に扱うクリエイター、開発者、事業者にとって、大容量ファイルを簡単に保護する事ができる事は、大きなメリットとなります。

### ５．技術的発見の将来展望
この世界初の技術的発見は、現在の活用範囲を大きく超えて、将来的により広範な技術革新の基盤となる可能性を秘めています。

#### ５．１．近未来での発展可能性
&emsp;**5.1.1 企業向け大規模バックアップシステムへの応用**  
&emsp;**5.1.2 クラウドインフラストラクチャとの高度統合**  
&emsp;**5.1.3 AI技術と組み合わせた完全自動化バックアップシステム**  
&emsp;**5.1.4 リアルタイム災害対策システムへの応用**

Chall-Link「VSSDetector」による技術的ブレークスルーは、これらすべての革新的発展の基盤技術として、長期的な技術進歩に貢献し続けることでしょう。

## ■【 免責事項 】
本手順の実行による損害や障害について、著作者は一切の責任を負いません。
重要なデータについては、事前に別途バックアップを取得してから実行してください。

共同利用環境、企業環境での実行は、必ず管理者・責任者と相談の上で行ってください。

システムの復元ポイント機能は、元々システム復元のためのものです。
本用途での使用は、あくまで革命的な技術的発見に基づく応用的活用であることをご理解ください。

以上
