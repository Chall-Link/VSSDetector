=================================================  
  
# Chall-Link「VSSDetector」 活用ガイド  
## 復元ポイントスナップショットを使ってドライブを丸ごと7-Zip暗号化アーカイブ  

## Windowsの隠れた機能を誰でも使えるように機能解放！
## 市販ソフトレベルのバックアップをフリーウェアで

## 【著作権者】	Chall-Link（シャルリンク）  
  
=================================================  

&nbsp;

## ■本・活用ガイドで使用するソフト
(1) Chall-Link「PreFAS Backup」（GitHub から入手）  
(2) 7-Zip（LGPLライセンス）（https://www.7-zip.org/ から入手）  

> 読んでいただくだけでご理解いただけるので、今は準備いただかなくて問題ありません
> PreFAS Backup の設定項目は、基本的に7-Zipや、Zip と同じです。

&nbsp;

## ■このガイドについて
Chall-Link「VSSDetector」は、Windowsの隠され機能 VSS スナップショット、すなわち、ある時点で静的に変更されない形で保存されているドライブのリソースを、一般ユーザーが自由に再利用できる事を実現します。

ここでは、VSSDetectorとChall-Link「PreFAS Backup」または7-Zipの組合わせを例に、Windows復元ポイントを利用してバックアップする具体的な手順をご紹介します。  
別ソフトChall-Link「PreFAS Backup」は、7-Zipの機能拡張スクリプトで、設定項目は7-Zipと同じです。  
（2025年6月7日現在、PreFAS Backupは、VSSDetector公開後、同時期に公開予定です。）  

&nbsp;

## ■具体的な使用例

### １．目標：VSS スナップショット内のフォルダを、アーカイブソースとして 7-Zipアーカイブを作成  
説明文の中ではドライブ丸ごとをソースにする説明もありますが、例えばドライブ丸ごとの場合は、処理に12時間以上かかる事も予想されます。その間Windows上での作業は可能ですが、体験ガイドとしては結果確認を早くできるよう、VSS スナップショット内のフォルダをソースに説明します。  
> 従来のソースのパス指定：（例）D:\  ※ 処理中は D:での作業を中断する必要があった  
>　　　　　　　　　　　↓  
> VSSDetector：（例）\\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\*  ※処理中に作業継続可能
**VSSDetector の技術的ブレークスルーで、従来容易ではなかった、大容量フォルダ／ドライブの7-Zip バックアップ処理中にソースフォルダ／ドライブで通常作業の継続可能が可能となります！**

&nbsp;

### ２．事前準備：復元ポイントの作成
> 復元ポイントの新規作成は、管理者・共同責任者の同意の上実施して下さい
> 復元ポイント作成時に対象ドライブに20%以上の空き容量（目安）が無いと正常処理ができませんのでご注意下さい

#### ２．１．ステップ1：システムの復元機能の有効化
&emsp;**2.1.1 システムの復元設定画面へのアクセス**  
&emsp;&emsp;Windowsの検索窓で「復元ポイントの作成」を検索し開くと  
&emsp;&emsp;「システムのプロパティウィンドウ／システムの保護タブ」が開きます  
  
&emsp;**2.1.2 【必須設定】システムドライブ（Cドライブ）の保護設定**  
&emsp;&emsp;システムの復元機能は、システムドライブ（Cドライブ）が有効である事が前提になっています  
&emsp;&emsp;Windows（システム）の保護が無効の場合は、Cドライブを選択し  
&emsp;&emsp;「構成」→「システムの保護を有効にする」を選択して Cドライブの保護を有効にします  
&emsp;&emsp;**ディスク領域の使用量：ディスクサイズの5-10%を推奨設定**  
  
&emsp;**2.1.3 【重要設定】データドライブ（Dドライブなど）の保護設定**  
&emsp;&emsp;バックアップ対象のデータドライブを選択し「構成」をクリック  
&emsp;&emsp;「システムの保護を有効にする」を選択  
&emsp;&emsp;**ディスク領域の使用量：1-3%を推奨設定**（小容量ドライブでは1-2%）  

&nbsp;

  > 有効にしただけではまだ復元ポイントは作成されません  

&nbsp;

#### ２．２．ステップ2：復元ポイントの作成  

&emsp; **2.2.1 復元ポイント作成プロセスの開始**
&emsp; &emsp;「システムのプロパティウィンドウ／システムの保護タブ」の「作成」ボタンをクリック

&emsp; **2.2.2 識別用説明の入力**
&emsp; &emsp;復元ポイントの説明欄に識別しやすい名称を入力
&emsp; &emsp;例：「PreFAS-25-06-06-1200」

&emsp; **2.2.3 復元ポイント作成処理の実行**
&emsp; &emsp;「作成」ボタンをクリック → 有効化されている全ドライブのスナップショットの作成が開始

&emsp; **2.2.4 作成成功の確認**
「復元ポイントは正常に作成されました」の表示を確認

&nbsp;

**これで、現時点でのドライブの静的が状態保存＝高品質スナップショットが作成完了しました！**
**これから、この復元ポイントのスナップショットを、使っていきます！**

&nbsp;

##### :bulb: **VSSDetectorの革命的なポイント！**
- **復元ポイント＝ある時点のドライブの状態の変化しない静的なスナップショット**  
- **復元ポイント作成後に、実ファイルを変更しても、スナップショット内のファイルは変化しない**  
- **スナップショットをソースにする事で「変化しないバックアップ元」と「作業の継続」の両立を実現**  

### ３．Chall-Link「VSSDetector」による VSSパス取得

#### ３．１．ステップ1：VSSDetectorの実行

&emsp; **3.1.1 管理者権限での確実な実行**
ChaL-VSSDetector.batを右クリック → 「管理者として実行」

&emsp; **3.1.2 高度な自動解析処理の実行**
スクリプトがシステム内のすべてのスナップショット情報を自動解析

&emsp; **3.1.3 実行完了の確認**
「スクリプトの実行が完了しました」のメッセージ確認後、画面を閉じる
> ※画面表示と同一の詳細結果が外部ファイルとしても出力されています

#### ３．２．ステップ2：VSSDetector VSSパス情報の確認と活用

(4) **詳細結果ファイルのアクセス**
実行フォルダに作成された「ChaL-RESULT-VSSDetector.txt」を開く

(5) **VSSDetector VSSパス情報の表示例**：
   ────────────────────────────
   [1] HarddiskVolumeShadowCopy1 (ドライブ D:)
       作成日時: 2024/06/06 14:30:25
       種類: システム復元ポイント
       ドライブ全体指定時パス表記: \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\*
       フォルダ指定時パス表記: \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\(フォルダ名)
   ────────────────────────────

(6) **VSSDetector VSSパスの選択とコピー**
バックアップ対象ドライブに対応する最適なVSSDetector VSSパスを慎重にコピー

■ VSSDetector VSSパス指定の重要ルール
・**ドライブ全体指定**：末尾に「\*」を必ず付加（例：〜Copy1\*）
・**特定フォルダ指定**：(フォルダ名)を実際の正確なフォルダ名に置換

★★　**これでスナップショットファイルへ直接アクセスするための「 VSSパス」の抽出が完了！**
次に、7-zip File Manager（小規模） または7-Zipを高度に機能拡張したPreFAS（大規模） による暗号化7-Zipアーカイブの作成方法を説明します。

【 アーカイブ・バックアップの実行 】

■ 方法1：7-zip GUIでの手動実行（小～中規模アーカイブ向け）

(1) **7-zip File Managerを管理者権限で起動**
(2) **VSSDetector VSSパスでの直接アクセス**
- アドレスバーに VSSDetector VSSパスを入力（末尾の\*は除く）
- 例：\\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\
(3) **アーカイブターゲットの選択**
- 対象フォルダを選択 → 「追加」を選択で、圧縮ウィンドウが開く
(4) **【重要】出力先の設定**
このままでは圧縮ファイルの出力先が、
\\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\
に設定されていますが、ここは書き込み禁止エリアなので、
圧縮先を、出力可能フォルダへのフルパス表記に変更します。
例：
× file-a.7z
○ d:\temp\file-a.7z

**GUI方式の制限事項**：大容量処理では非現実的、CPU負荷制御機能なしなど

■ 方法2：PreFASでの拡張7-Zip処理の実行（ドライブ丸ごとなど、大容量バックアップ向け）

**PreFASによる市販ソフトレベル機能の実現**：
・**4TB越えのフォルダ／ドライブを想定した全自動7-Zipアーカイブシステム**
・**CPU負荷制御による安定した長時間処理の実現**
・**AES-256暗号化によるセキュアなクラウド保存完全対応**
・**M-Disc（100年耐久性）、Blu-rayディスクに完全最適化された分割サイズ設定**
・**プロフェッショナル品質のエラーハンドリングシステム**

(1) **PreFAS-Sub.batの設定**
テキストエディタでPreFAS-Sub.batを開き、「アーカイブするソースフォルダ」を設定：

**D:ドライブ全体をバックアップする場合**：
```
set SOURCE_FOLDER="\\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\*"
```

**特定フォルダ（D:\FOL-1\FOL-2）をバックアップする場合**：
```
set SOURCE_FOLDER="\\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\FOL-1\FOL-2"
```

(2) **その他の重要設定項目の最適化**
・出力アーカイブファイル名の設定
・アーカイブファイル出力フォルダの最適化
・除外ファイル、除外フォルダの指定

(3) **PreFAS-Main.batの確実な実行**
右クリック → 「管理者として実行」

(4) **企業級パスワード設定**
AES-256暗号化用の強力なパスワードを2回入力（英数字や記号を含む20〜30桁以上を強く推奨）

(5) **自動処理の開始**
- 背景色が水色で表示され、高度な自動処理が開始
- CPU負荷が最適に制御され、処理中でもファイル編集作業が完全に可能
- 完了時に「Everything is Ok」が表示され、企業級品質を保証

【 フリーウェアでありながら企業級の高度アーカイブ処理を完全実現 】
● **バックアップ側（革新的技術）**：復元ポイント作成時の静的状態を100%確実にアーカイブ
● **作業側（生産性の大幅な向上）**：アーカイブ処理中でもソースドライブ/フォルダで通常の編集作業が完全に可能
● **システム側（最適化制御）**：PreFASの高度な負荷制御により、他作業への影響を最小化、PCハードウェアへの過剰負荷を完全に抑制

【 絶対に遵守すべき重要な制約事項 】

■ **致命的な禁止事項（違反すると処理が完全に失敗します）**
・**VSSDetector VSSパス使用中の新しい復元ポイント作成は絶対禁止**
・**処理中のシャットダウン・再起動は絶対禁止**
・**休止モード・スリープモードへの移行は絶対禁止**

■ **PC負荷の監視**
PCファンが極度に高速回転するなどPCに異常を感じた場合、即座にCtrl+Cでスクリプトを中断し使用を完全中止してください。

■ **システムに重大な影響を与える処理の禁止**
・ディスククリーンアップの実行禁止
・PreFAS実行中にWindows Updateが再起動を要求してきた場合は「後で再起動」で延長するか、
PreFASの実行をCtrl+Cで中止して再起動するかを選択してください。
・長時間PCに高負荷がかかる他ソフトでの同時処理は避ける

■ **重要な注意事項・推奨戦略**
・**PreFAS実行直前の必須作業**：忘れずに最新の復元ポイントを作成することで最新状態の完全バックアップを実現
・**暗号化検証の必須実行**：暗号化アーカイブファイルが完成したら、必ず7-Zip File Managerで開いてパスワードの有効性を確認
・**パスワードの厳重管理**：パスワードは大切に保存（紛失した場合、復元手段は存在しません）
・**クラウド保存戦略**：クラウド保存する場合は、まずローカルドライブに出力してからアップロードする方式を強く推奨

【 トラブルシューティング・FAQ 】

● **Q: PreFASでVSSDetector VSSパスが認識されない**
A: 以下の項目を確認してください
- ドライブ全体指定：末尾に「\*」が必須
- フォルダ指定：実際の正確なフォルダ名に置換されているか
- 対象復元ポイントが確実に存在しているか

● **Q: バックアップ処理中にエラーが発生した**
A: 以下を段階的に確認してください
- 最新の復元ポイント情報を使用できているか？VSSDetectorで情報を再取得して確認
- Results_PreFAS_ERROR_*.logファイルの詳細内容を精査

● **Q: 復元ポイントが作成されない**
A: 以下の基本要件を確認してください
- ディスク容量不足の有無
- システムの復元設定
- VSSサービスの動作状況

● **Q: 処理後の復元ポイントを削除すべきか？**
A: 以下の判断基準に従ってください
- ディスク容量に余裕がある場合：そのまま温存して将来的な活用に備える
- 容量が制限される場合：設定した容量制限を超えると古いものから自動削除される仕組みを活用

【 復元ポイントの管理・削除 】
■ 復元ポイントの安全な削除方法（※共同利用環境では必ず管理者・責任者と事前相談してから実施）

(1) Windowsの検索窓で「復元ポイントの作成」を検索しアクセス
(2) 削除対象ドライブを慎重に選択し「構成」をクリック
(3) 以下のいずれかを選択：
- **「削除」**：該当ドライブの復元ポイントをすべて完全削除
- **「システムの保護を無効にする」**：削除と共に今後の復元ポイント作成機能も完全停止

【 この革命的手法の本質的価値と歴史的意義 】
このスクリプトは単なる技術的手法を越えて、**現代のバックアップ・プロセスに一石を投じる革新的なアプローチ**です。

**従来の根本的制約からの完全解放**
これまで相反関係にあった「確実なバックアップ実行」と「継続的な作業」を、フリーウェアレベルで両立させることに成功しました。

**生産性革命の実現**
従来は避けられなかった数時間〜1日の作業停止時間を完全にゼロ化し、創造的活動の中断を根本的に排除します。

**技術的ブレークスルーの歴史的意義**
Chall-Link「VSSDetector」による技術的発見は、個人レベルでの「攻撃的創造」と「堅実な保護」の同時実現を可能にした、デジタル時代における歴史的な技術革新です。

**対象分野**
特に大容量データを日常的に扱うクリエイター、開発者、事業者にとって、大容量ファイルを簡単に保護する事ができる事は、大きなメリットとなります。

【 技術的発見の将来展望 】
この世界初の技術的発見は、現在の活用範囲を大きく超えて、将来的により広範な技術革新の基盤となる可能性を秘めています。

**近未来での発展可能性**
・企業向け大規模バックアップシステムへの応用
・クラウドインフラストラクチャとの高度統合
・AI技術と組み合わせた完全自動化バックアップシステム
・リアルタイム災害対策システムへの応用

Chall-Link「VSSDetector」による技術的ブレークスルーは、これらすべての革新的発展の基盤技術として、長期的な技術進歩に貢献し続けることでしょう。

【 免責事項 】
本手順の実行による損害や障害について、著作者は一切の責任を負いません。
重要なデータについては、事前に別途バックアップを取得してから実行してください。

共同利用環境、企業環境での実行は、必ず管理者・責任者と相談の上で行ってください。

システムの復元ポイント機能は、元々システム復元のためのものです。
本用途での使用は、あくまで革命的な技術的発見に基づく応用的活用であることをご理解ください。

以上
